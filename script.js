// All Music
let allMusic = [
  {
    name: "Bật Tình Yêu Lên",
    artist: "Tăng Duy Tân x Hòa Minzy",
    img: "./img/music/bat_tinh_yeu_len.jpg",
    src: "./music/bat_tinh_yeu_len.mp3",
    idMusic: "song1",
  },
  {
    name: "Chỉ Cần Em Muốn",
    artist: "NP.2 x Hngle",
    img: "./img/music/chi_can_em_muon.jpeg",
    src: "./music/chi_can_em_muon.mp3",
    idMusic: "song2",
  },
  {
    name: "Em Đồng Ý Nha",
    artist: "Nguyễn Quang Quý",
    img: "./img/music/em_dong_y_nha.jpeg",
    src: "./music/em_dong_y_nha.mp3",
    idMusic: "song3",
  },
  {
    name: "Mặt Mộc",
    artist: "Phạm Ngọc Nguyên ft VAnh",
    img: "./img/music/mat_moc.jpg",
    src: "./music/mat_moc.mp3",
    idMusic: "song4",
  },
  {
    name: "Nơi Này Có Anh",
    artist: "Sơn Tùng MT-P",
    img: "./img/music/noi_nay_co_anh.jpg",
    src: "./music/noi_nay_co_anh.mp3",
    idMusic: "song5",
  },
  {
    name: "Người Yêu Tương Lai",
    artist: "Thảo Phạm",
    img: "./img/music/nguoi_yeu_tuong_lai.jpg",
    src: "./music/nguoi_yeu_tuong_lai.mp3",
    idMusic: "song6",
  },
  {
    name: "Hai Mươi Hai",
    artist: "Amee x Hứa Kim Tuyền",
    img: "./img/music/22.jpg",
    src: "./music/22.mp3",
    idMusic: "song7",
  },
  {
    name: "Muộn Rồi Mà Sao Còn",
    artist: "Sơn Tùng M-TP",
    img: "./img/music/muon_roi_ma_sao_con.png",
    src: "./music/muon_roi_ma_sao_con.mp3",
    idMusic: "song8",
  },
  {
    name: "Tell Ur Mom II",
    artist: "Winno ft. Heily「Cukak Remix」",
    img: "./img/music/tell_ur_mom_2.jpg",
    src: "./music/tell_ur_mom_2.mp3",
    idMusic: "song9",
  },
  {
    name: "Xích Thêm Chút",
    artist: "RPT Groovie ft TLinh x RPT MCK",
    img: "./img/music/xich_them_chut.jpg",
    src: "./music/xich_them_chut.mp3",
    idMusic: "song10",
  },
  {
    name: "Gió",
    artist: "JanK x Quanvrox",
    img: "./img/music/gio.jpg",
    src: "./music/gio.mp3",
    idMusic: "song11",
  },
  {
    name: "Có Chắc Yêu Là Đây",
    artist: "Sơn Tùng MT-P",
    img: "./img/music/co_chac_yeu_la_day.jpg",
    src: "./music/co_chac_yeu_la_day.mp3",
    idMusic: "song12",
  },
  {
    name: "Forget Me Now",
    artist: "Fishy ft. Trí Dũng",
    img: "./img/music/forget_me_now.jpg",
    src: "./music/forget_me_now.mp3",
    idMusic: "song13",
  },
  {
    name: "Falling In Love",
    artist: "Na Ngọc Anh",
    img: "./img/music/falling_in_love.jpg",
    src: "./music/falling_in_love.mp3",
    idMusic: "song14",
  },
  {
    name: "Không Phải Dạng Vừa Đâu",
    artist: "Sơn Tùng MT-P",
    img: "./img/music/khong_phai_dang_vua_dau.jpg",
    src: "./music/khong_phai_dang_vua_dau.mp3",
    idMusic: "song15",
  },
  {
    name: "Anh Đã Quen Với Cô Đơn",
    artist: "Soobin Hoàng Sơn",
    img: "./img/music/anh_da_quen_voi_co_don.jpg",
    src: "./music/anh_da_quen_voi_co_don.mp3",
    idMusic: "song16",
  },
  {
    name: "Tình Yêu Màu Hồng",
    artist: "Hồ Văn Quý x Xám x Freak D",
    img: "./img/music/tinh_yeu_mau_hong.jpg",
    src: "./music/tinh_yeu_mau_hong.mp3",
    idMusic: "song17",
  },
  {
    name: "Tình Ca Tình Ta",
    artist: "Kis",
    img: "./img/music/tinh_ca_tinh_ta.jpg",
    src: "./music/tinh_ca_tinh_ta.mp3",
    idMusic: "song18",
  },
  {
    name: "Ừ Có Anh Đây",
    artist: "Tino",
    img: "./img/music/u_co_anh_day.jpg",
    src: "./music/u_co_anh_day.mp3",
    idMusic: "song19",
  },
  {
    name: "Răng Khôn",
    artist: "Phí Phương Anh",
    img: "./img/music/rang_khon.jpg",
    src: "./music/rang_khon.mp3",
    idMusic: "song20",
  },
  {
    name: "Người Lạ Ơi",
    artist: "Superbrothers x Karik x Orange",
    img: "./img/music/nguoi_la_oi.jpg",
    src: "./music/nguoi_la_oi.mp3",
    idMusic: "song21",
  },
  {
    name: "Quằng Lắm Em Ơi",
    artist: "DT, Mai Xuân Thứ ft Kim Ngân",
    img: "./img/music/quang_lam_em_oi.jpg",
    src: "./music/quang_lam_em_oi.mp3",
    idMusic: "song22",
  },
  {
    name: "3107-2 (Lofi Ver.)",
    artist: "DuongG x Nâu x W/n x Freak D",
    img: "./img/music/3107_2.jpg",
    src: "./music/3107_2.mp3",
    idMusic: "song23",
  },
  {
    name: "Như Anh Đã Thấy Em",
    artist: "PhucXp ft. Freak D",
    img: "./img/music/nhu_anh_da_thay_em.jpg",
    src: "./music/nhu_anh_da_thay_em.mp3",
    idMusic: "song24",
  },
  {
    name: "Thế Giới Trong Em",
    artist: "Hương Ly (speed up)",
    img: "./img/music/the_gioi_trong_em.jpg",
    src: "./music/the_gioi_trong_em.mp3",
    idMusic: "song25",
  },
  {
    name: "Giúp Anh Trả Lời Những Câu Hỏi",
    artist: "Vương Anh Tú",
    img: "./img/music/giup_anh_tra_loi_nhung_cau_hoi.jpg",
    src: "./music/giup_anh_tra_loi_nhung_cau_hoi.mp3",
    idMusic: "song26",
  },
  {
    name: "3107",
    artist: "Nâu, titie , Dươngg",
    img: "./img/music/3107.jpg",
    src: "./music/3107.mp3",
    idMusic: "song27",
  },
  {
    name: "Liệu Giờ",
    artist: "2T",
    img: "./img/music/lieu_gio.jpg",
    src: "./music/lieu_gio.mp3",
    idMusic: "song28",
  },
  {
    name: "Bốn Mùa Thương Em",
    artist: "Lập Nguyên",
    img: "./img/music/bon_mua_thuong_em.jpg",
    src: "./music/bon_mua_thuong_em.mp3",
    idMusic: "song29",
  },
  {
    name: "Lạc Vào Em",
    artist: "Lê Vũ",
    img: "./img/music/lac_vao_em.jpg",
    src: "./music/lac_vao_em.mp3",
    idMusic: "song30",
  },
  {
    name: "Tình Này Có Em",
    artist: "Lê Vũ",
    img: "./img/music/tinh_nay_co_em.jpg",
    src: "./music/tinh_nay_co_em.mp3",
    idMusic: "song31",
  },
  {
    name: "Thằng Điên",
    artist: "JustaTee ft Phương Ly",
    img: "./img/music/thang_dien.jpg",
    src: "./music/thang_dien.mp3",
    idMusic: "song32",
  },
  {
    name: "Anh Đánh Rơi Người Yêu Này",
    artist: "Amee ft. Andiez",
    img: "./img/music/anh_danh_roi_nguoi_yeu_nay.jpg",
    src: "./music/anh_danh_roi_nguoi_yeu_nay.mp3",
    idMusic: "song33",
  },
  {
    name: "Như Bến Đợi Đò",
    artist: "Khánh Ân ft. Hana Cẩm Tiên",
    img: "./img/music/nhu_ben_doi_do.jpg",
    src: "./music/nhu_ben_doi_do.mp3",
    idMusic: "song34",
  },
  {
    name: "Bắt Cóc Con Tim",
    artist: "Lou Hoàng",
    img: "./img/music/bat_coc_con_tim.jpg",
    src: "./music/bat_coc_con_tim.mp3",
    idMusic: "song35",
  },
  {
    name: "Don't Côi",
    artist: "RPT Orijinn x Ronboogz",
    img: "./img/music/dont_coi.jpg",
    src: "./music/dont_coi.mp3",
    idMusic: "song36",
  },
  {
    name: "Yêu Không Cần Hứa",
    artist: "Vương Anh Tú",
    img: "./img/music/yeu_khong_can_hua.jpg",
    src: "./music/yeu_khong_can_hua.mp3",
    idMusic: "song37",
  },
  {
    name: "Xin Đừng Lặng Im",
    artist: "Soobin Hoàng Sơn",
    img: "./img/music/xin_dung_lang_im.jpg",
    src: "./music/xin_dung_lang_im.mp3",
    idMusic: "song38",
  },
  {
    name: "IU Anh Thế Thôi",
    artist: "Sean x Muội x Angfang",
    img: "./img/music/iu_anh_the_thoi.jpeg",
    src: "./music/iu_anh_the_thoi.mp3",
    idMusic: "song39",
  },
  {
    name: "Có Đâu Ai Ngờ",
    artist: "Cầm",
    img: "./img/music/co_dau_ai_ngo.jpeg",
    src: "./music/co_dau_ai_ngo.mp3",
    idMusic: "song40",
  },
  {
    name: "Yêu Em Hơn Mỗi Ngày",
    artist: "Andiez",
    img: "./img/music/yeu_em_hon_moi_ngay.jpg",
    src: "./music/yeu_em_hon_moi_ngay.mp3",
    idMusic: "song41",
  },
  {
    name: "Lắng Nghe Nước Mắt",
    artist: "Mr.Siro",
    img: "./img/music/lang_nghe_nuoc_mat.jpg",
    src: "./music/lang_nghe_nuoc_mat.mp3",
    idMusic: "song42",
  },
  {
    name: "Nỗi Đau Mình Anh",
    artist: "Châu Khải Phong",
    img: "./img/music/noi_dau_minh_anh.jpg",
    src: "./music/noi_dau_minh_anh.mp3",
    idMusic: "song43",
  },
  {
    name: "Em Là Nhất",
    artist: "Kis x Hoàng KayLee x Yahy",
    img: "./img/music/em_la_nhat.jpg",
    src: "./music/em_la_nhat.mp3",
    idMusic: "song44",
  },
  {
    name: "Ngày Đầu Tiên",
    artist: "Đức Phúc",
    img: "./img/music/ngay_dau_tien.jpg",
    src: "./music/ngay_dau_tien.mp3",
    idMusic: "song45",
  },
  {
    name: "Sóng Gió",
    artist: "Jack ft. K-ICM",
    img: "./img/music/song_gio.jpg",
    src: "./music/song_gio.mp3",
    idMusic: "song46",
  },

  {
    name: "Bạc Phận",
    artist: "Jack ft. K-ICM",
    img: "./img/music/bac_phan.jpg",
    src: "./music/bac_phan.mp3",
    idMusic: "song47",
  },
  {
    name: "Pháo Hồng",
    artist: "Đặt Long Vinh",
    img: "./img/music/phao_hong.jpg",
    src: "./music/phao_hong.mp3",
    idMusic: "song48",
  },
  {
    name: "Ép Duyên",
    artist: "Long Nón Lá",
    img: "./img/music/ep_duyen.jpg",
    src: "./music/ep_duyen.mp3",
    idMusic: "song49",
  },
  {
    name: "Dạ Vũ",
    artist: "Tăng Duy Tân x Phong Max",
    img: "./img/music/da_vu.jpg",
    src: "./music/da_vu.mp3",
    idMusic: "song50",
  },
  {
    name: "Ngây Thơ",
    artist: "Tăng Duy Tân x Phong Max",
    img: "./img/music/ngay_tho.jpg",
    src: "./music/ngay_tho.mp3",
    idMusic: "song51",
  },
  {
    name: "Thích Thích",
    artist: "Phương Ly",
    img: "./img/music/thich_thich.jpg",
    src: "./music/thich_thich.mp3",
    idMusic: "song52",
  },
  {
    name: "Phận Duyên Lỡ Làng",
    artist: "Phát Huy T4 x Truzg",
    img: "./img/music/phan_duyen_lo_lang.jpg",
    src: "./music/phan_duyen_lo_lang.mp3",
    idMusic: "song53",
  },
  {
    name: "Đường Quyền Tình Yêu",
    artist: "DatKaa x QT Beatz",
    img: "./img/music/duong_quyen_tinh_yeu.jpg",
    src: "./music/duong_quyen_tinh_yeu.mp3",
    idMusic: "song54",
  },
  {
    name: "Anh Yêu Vội Thế",
    artist: "LaLa Trần",
    img: "./img/music/anh_yeu_voi_the.jpg",
    src: "./music/anh_yeu_voi_the.mp3",
    idMusic: "song55",
  },
  {
    name: "Anh Thanh Niên",
    artist: "HuyR",
    img: "./img/music/anh_thanh_nien.jpg",
    src: "./music/anh_thanh_nien.mp3",
    idMusic: "song56",
  },
  {
    name: "Hồng Nhan",
    artist: "Jack",
    img: "./img/music/hong_nhan.jpg",
    src: "./music/hong_nhan.mp3",
    idMusic: "song57",
  },
  {
    name: "Bên Trên Tầng Lầu",
    artist: "Tăng Duy Tân",
    img: "./img/music/ben_tren_tang_lau.jpg",
    src: "./music/ben_tren_tang_lau.mp3",
    idMusic: "song58",
  },
  {
    name: "Câu Hứa Chưa Vẹn Tròn",
    artist: "Phát Huy T4 x Hoàng Green",
    img: "./img/music/cau_hua_chua_ven_tron.jpg",
    src: "./music/cau_hua_chua_ven_tron.mp3",
    idMusic: "song59",
  },
  {
    name: "Anh Có Muốn Đưa Em Về Không",
    artist: "Ngô Lan Hương",
    img: "./img/music/anh_co_muon_dua_em_ve_khong.jpeg",
    src: "./music/anh_co_muon_dua_em_ve_khong.mp3",
    idMusic: "song60",
  },
  {
    name: "Cô Gái Vàng",
    artist: "HuyR x Tùng Viu x Quang Đăng",
    img: "./img/music/co_gai_vang.jpg",
    src: "./music/co_gai_vang.mp3",
    idMusic: "song61",
  },
  {
    name: "Cố Giang Tình",
    artist: "Phát Hồ x JokeS Bii ft. DinhLong",
    img: "./img/music/co_giang_tinh.jpg",
    src: "./music/co_giang_tinh.mp3",
    idMusic: "song62",
  },
  {
    name: "Không Yêu Xin Đừng Nói",
    artist: "Umie",
    img: "./img/music/khong_yeu_xin_dung_noi.jpeg",
    src: "./music/khong_yeu_xin_dung_noi.mp3",
    idMusic: "song63",
  },
  {
    name: "Xin Má Rước Dâu",
    artist: "Diệu Kiên",
    img: "./img/music/xin_ma_ruoc_dau.jpg",
    src: "./music/xin_ma_ruoc_dau.mp3",
    idMusic: "song64",
  },

  {
    name: "Thiệp Hồng Người Dưng",
    artist: "Phát Hồ x JokeS Bii x Sinike ft. DinhLong",
    img: "./img/music/thiep_hong_nguoi_dung.jpg",
    src: "./music/thiep_hong_nguoi_dung.mp3",
    idMusic: "song65",
  },
  {
    name: "Chỉ Muốn Bên Em Thật Gần",
    artist: "Y Ling x Nguyễn Minh Phúc",
    img: "./img/music/chi_muon_ben_em_that_gan.jpg",
    src: "./music/chi_muon_ben_em_that_gan.mp3",
    idMusic: "song66",
  },
  {
    name: "Yêu Rồi",
    artist: "Cris Phan x Mai Quỳnh Anh",
    img: "./img/music/yeu_roi.jpg",
    src: "./music/yeu_roi.mp3",
    idMusic: "song67",
  },
  {
    name: "Họa Mây",
    artist: "X2X Band ft. DinhLong",
    img: "./img/music/hoa_may.jpg",
    src: "./music/hoa_may.mp3",
    idMusic: "song68",
  },
  {
    name: "Cô Gái M52",
    artist: "HuyR x Tùng Viu",
    img: "./img/music/co_gai_m52.jpg",
    src: "./music/co_gai_m52.mp3",
    idMusic: "song69",
  },
  {
    name: "Nếu Ngày Ấy",
    artist: "Soobin Hoàng Sơn",
    img: "./img/music/neu_ngay_ay.jpg",
    src: "./music/neu_ngay_ay.mp3",
    idMusic: "song70",
  },
  {
    name: "Hồi Ức Ta Đã Yêu",
    artist: "Linh Hương Luz x KProx",
    img: "./img/music/hoi_uc_ta_da_yeu.jpg",
    src: "./music/hoi_uc_ta_da_yeu.mp3",
    idMusic: "song71",
  },
  {
    name: "Suýt Nữa Thì",
    artist: "Andiez",
    img: "./img/music/suyt_nua_thi.jpg",
    src: "./music/suyt_nua_thi.mp3",
    idMusic: "song72",
  },
  {
    name: "Tiếng Tơ Lòng",
    artist: "H-Kray",
    img: "./img/music/tieng_to_long.jpg",
    src: "./music/tieng_to_long.mp3",
    idMusic: "song73",
  },
  {
    name: "Chỉ Cần Em Hạnh Phúc",
    artist: "Hồ Quang Hiếu x Sơn Tùng M-TP",
    img: "./img/music/chi_can_em_hanh_phuc.jpeg",
    src: "./music/chi_can_em_hanh_phuc.mp3",
    idMusic: "song74",
  },
  {
    name: "Tấm Lòng Son",
    artist: "H-Kray",
    img: "./img/music/tam_long_son.jpg",
    src: "./music/tam_long_son.mp3",
    idMusic: "song75",
  },
  {
    name: "Ý Em Sao",
    artist: "Kay Trần",
    img: "./img/music/y_em_sao.jpeg",
    src: "./music/y_em_sao.mp3",
    idMusic: "song76",
  },
  {
    name: "Đổi Thay",
    artist: "Hồ Quang Hiếu",
    img: "./img/music/doi_thay.jpg",
    src: "./music/doi_thay.mp3",
    idMusic: "song77",
  },
  {
    name: "Tình Anh Không Đổi Thay",
    artist: "Du Thiên",
    img: "./img/music/tinh_anh_khong_doi_thay.jpeg",
    src: "./music/tinh_anh_khong_doi_thay.mp3",
    idMusic: "song78",
  },
  {
    name: "Thêm Bao Nhiêu Lâu",
    artist: "Đạt G",
    img: "./img/music/them_bao_nhieu_lau.jpg",
    src: "./music/them_bao_nhieu_lau.mp3",
    idMusic: "song79",
  },
  {
    name: "Điều Anh Biết",
    artist: "Chi Dân",
    img: "./img/music/dieu_anh_biet.jpg",
    src: "./music/dieu_anh_biet.mp3",
    idMusic: "song80",
  },
  {
    name: "Thu Cuối",
    artist: "Mr.T ft Yanbi & Hằng Bingboong",
    img: "./img/music/thu_cuoi.jpg",
    src: "./music/thu_cuoi.mp3",
    idMusic: "song81",
  },
  {
    name: "Phía Sau Em",
    artist: "Kay Trần ft Binz",
    img: "./img/music/phia_sau_em.jpg",
    src: "./music/phia_sau_em.mp3",
    idMusic: "song82",
  },
  {
    name: "Sự Thật Sau Một Lời Hứa",
    artist: "Chi Dân",
    img: "./img/music/su_that_sau_mot_loi_hua.jpg",
    src: "./music/su_that_sau_mot_loi_hua.mp3",
    idMusic: "song83",
  },
  {
    name: "Dễ Thương",
    artist: "Khởi My",
    img: "./img/music/de_thuong.jpg",
    src: "./music/de_thuong.mp3",
    idMusic: "song84",
  },
  {
    name: "Ngày Mai Em Đi",
    artist: "Touliver x Lê Hiếu x Soobin Hoàng Sơn",
    img: "./img/music/ngay_mai_em_di.jpg",
    src: "./music/ngay_mai_em_di.mp3",
    idMusic: "song85",
  },
  {
    name: "Chiều Thu Họa Bóng Nàng",
    artist: "DatKaa x QT Beatz",
    img: "./img/music/chieu_thu_hoa_bong_nang.jpg",
    src: "./music/chieu_thu_hoa_bong_nang.mp3",
    idMusic: "song86",
  },
  {
    name: "2AM",
    artist: "JustaTee feat Big Daddy",
    img: "./img/music/2am.jpg",
    src: "./music/2am.mp3",
    idMusic: "song87",
  },
  {
    name: "Đừng Lo Anh Đợi Mà",
    artist: "Mr.Siro",
    img: "./img/music/dung_lo_anh_doi_ma.jpg",
    src: "./music/dung_lo_anh_doi_ma.mp3",
    idMusic: "song88",
  },
  {
    name: "Hẹn Em Ở Lần Yêu Thứ 2",
    artist: "Nguyenn x Đặng Tuấn Vũ ",
    img: "./img/music/hen_em_o_lan_yeu_thu_2.jpg",
    src: "./music/hen_em_o_lan_yeu_thu_2.mp3",
    idMusic: "song89",
  },
  {
    name: "Thay Tôi Yêu Cô Ấy",
    artist: "Thanh Hưng",
    img: "./img/music/thay_toi_yeu_co_ay.jpg",
    src: "./music/thay_toi_yeu_co_ay.mp3",
    idMusic: "song90",
  },
  {
    name: "Gác Lại Âu Lo",
    artist: "Da LAB ft. Miu Lê",
    img: "./img/music/gac_lai_au_lo.jpg",
    src: "./music/gac_lai_au_lo.mp3",
    idMusic: "song91",
  },
  {
    name: "Em Là Nhất Miền Tây",
    artist: "Võ Lê Mi x Jin Tuấn Nam",
    img: "./img/music/em_la_nhat_mien_tay.jpg",
    src: "./music/em_la_nhat_mien_tay.mp3",
    idMusic: "song92",
  },
  {
    name: "Chuyện Đôi Ta",
    artist: "Da LAB ft. Muộii",
    img: "./img/music/chuyen_doi_ta.jpg",
    src: "./music/chuyen_doi_ta.mp3",
    idMusic: "song93",
  },
  {
    name: "Yêu Nhau Nhé Bạn Thân",
    artist: "Phạm Đình Thái Ngân",
    img: "./img/music/yeu_nhau_nhe_ban_than.jpg",
    src: "./music/yeu_nhau_nhe_ban_than.mp3",
    idMusic: "song94",
  },
  {
    name: "Hoa Cỏ Lau",
    artist: "Phong Max | H2K Cover",
    img: "./img/music/hoa_co_lau.jpeg",
    src: "./music/hoa_co_lau.mp3",
    idMusic: "song95",
  },
  {
    name: "Khuê Mộc Lang",
    artist: "Hương Ly & Jombie (G5R)",
    img: "./img/music/khue_moc_lang.jpeg",
    src: "./music/khue_moc_lang.mp3",
    idMusic: "song96",
  },
  {
    name: "IU Là Đây",
    artist: "Sean x Muộii x Anfang",
    img: "./img/music/iu_la_day.jpg",
    src: "./music/iu_la_day.mp3",
    idMusic: "song97",
  },
  {
    name: "Thê Tử",
    artist: "Hương Ly ft. Minh Vương M4U",
    img: "./img/music/the_tu.jpg",
    src: "./music/the_tu.mp3",
    idMusic: "song98",
  },
  {
    name: "Đông Phai Mờ Dáng Ai",
    artist: "DatKaa x QT Beatz",
    img: "./img/music/dong_phai_mo_dang_ai.jpg",
    src: "./music/dong_phai_mo_dang_ai.mp3",
    idMusic: "song99",
  },
  {
    name: "Thức Giấc",
    artist: "Da LAB",
    img: "./img/music/thuc_giac.jpg",
    src: "./music/thuc_giac.mp3",
    idMusic: "song100",
  },
];

const playlist = document.querySelector(".playlist");
const cd = document.querySelector(".cd");
const cdThumb = document.querySelector(".cd-thumb");
const musicName = document.querySelector("header h2");
const musicArtist = document.querySelector("header h3");
const progress = document.querySelector(".progress");
const progressbar = document.querySelector(".progress-bar");
const myControlBtn = document.querySelector("#btn-my-controls");
const myControls = document.querySelector("#btn-my-controls #icon");
const prevBtn = document.querySelector("#btn-prev");
const nextBtn = document.querySelector("#btn-next");
const playBtn = document.querySelector("#btn-play");
const playbackTimeBtn = document.querySelector("#btn-playback-time");
const playbackTimer = document.querySelector(".playback-timer");
const songAudio = document.createElement("audio");

let currentIndex = 0;
let isPlaying = false;
let isRandom = false;
let isRepeat = false;
let isPlaybackTime = false;
let stopMusic = null;
let countdown = null;

window.addEventListener("load", () => {
  loadMusic(currentIndex);
  playSongMusic();
});

// Playlist
for (let i = 0; i < allMusic.length; i++) {
  let song = `<div class="song" musicIndex="${i}">
                <div class="left">
                  <div
                    class="img-song"
                    style="background-image: url('${allMusic[i].img}')">
                  </div>
                  <div class="song-title">
                    <h3 class="name">${allMusic[i].name}</h3>
                    <p class="artist">${allMusic[i].artist}</p>
                  </div>
                </div>
                <audio class="${allMusic[i].idMusic}" src="${allMusic[i].src}">
                </audio>
                <div id="${allMusic[i].idMusic}" class="audio-duration">
                  <i class="fas fa-ellipsis-h"></i>
                </div>
              </div>`;
  playlist.insertAdjacentHTML("beforeend", song);
  let songAudioDuration = document.querySelector(`#${allMusic[i].idMusic}`);
  let songAudioTag = document.querySelector(`.${allMusic[i].idMusic}`);
  // -------hiển thị thời gian bài hát------------
  songAudioTag.addEventListener("loadeddata", () => {
    let audioDuration = songAudioTag.duration;
    let totalMusicmin = Math.floor(audioDuration / 60);
    let totalMusicsec = Math.floor(audioDuration % 60);
    if (totalMusicsec < 10) {
      totalMusicsec = `0${totalMusicsec}`;
    }
    songAudioDuration.innerText = `${totalMusicmin}:${totalMusicsec}`;
  });
}
//
const allSongMusic = playlist.querySelectorAll(".song");

function playSongMusic() {
  for (let j = 0; j < allSongMusic.length; j++) {
    if (allSongMusic[j].classList.contains("active")) {
      allSongMusic[j].classList.remove("active");
    }
    if (allSongMusic[j].getAttribute("musicIndex") == currentIndex) {
      allSongMusic[j].classList.add("active");
    }
    allSongMusic[j].setAttribute("onclick", "clicked(this)");
  }
}

function clicked(index) {
  let getSongIndex = index.getAttribute("musicIndex");
  currentIndex = getSongIndex;
  loadMusic(currentIndex);
  playSong();
  playSongMusic();
}

function scrollToActiveSong() {
  setTimeout(() => {
    const activeSong = document.querySelector(".song.active");
    if (activeSong) {
      activeSong.scrollIntoView({
        behavior: "smooth",
        block: "nearest",
      });
    }
  }, 300);
}

// Load Music
function loadMusic(index) {
  musicName.innerText = allMusic[index].name;
  musicArtist.innerText = allMusic[index].artist;
  cdThumb.style.backgroundImage = `url(${allMusic[index].img})`;
  songAudio.src = allMusic[index].src;
  songAudio.load();
}
loadMusic(currentIndex);

// Phóng to / Thu nhỏ CD
const cdWidth = cd.offsetWidth;

document.onscroll = function () {
  const scrollTop = window.scrollY || document.documentElement.scrollTop;
  const newCdWidth = cdWidth - scrollTop;

  cd.style.width = newCdWidth > 0 ? newCdWidth + "px" : 0;
  cd.style.opacity = newCdWidth / cdWidth;
};

// Xử lý CD quay / dừng
const cdThumbAnimation = cdThumb.animate([{ transform: "rotate(360deg)" }], {
  duration: 10000,
  iterations: Infinity,
});
cdThumbAnimation.pause();

// Play song
function musicPlay() {
  if (isPlaying) {
    pauseSong();
  } else {
    playSong();
  }
}
function playSong() {
  songAudio.play();
  cdThumbAnimation.play();
  isPlaying = true;
  playBtn.title = "Pause";
  playBtn.innerHTML = '<i class="fa-solid fa-pause"></i>';
}

function pauseSong() {
  songAudio.pause();
  cdThumbAnimation.pause();
  isPlaying = false;
  playBtn.title = "Play";
  playBtn.innerHTML = '<i class="fa-solid fa-play"></i>';
}

// Next song
function nextSong() {
  if (isRandom) {
    currentIndex = randomSong();
  } else if (currentIndex < allMusic.length - 1) {
    currentIndex++;
  } else {
    currentIndex = 0;
  }
  loadMusic(currentIndex);
  playSongMusic();
  playSong();
  scrollToActiveSong();
}
nextBtn.onclick = function () {
  nextSong();
};

// Prev song
function prevSong() {
  if (isRandom) {
    currentIndex = randomSong();
  } else if (currentIndex > 0) {
    currentIndex--;
  } else {
    currentIndex = allMusic.length - 1;
  }
  loadMusic(currentIndex);
  playSongMusic();
  playSong();
  scrollToActiveSong();
}
prevBtn.onclick = function () {
  prevSong();
};

// Tự động chuyển bài khi kết thúc
songAudio.addEventListener("ended", () => {
  if (isRepeat) {
    songAudio.play();
  } else {
    nextSong();
  }
});

// Random & Repeat
myControlBtn.addEventListener("click", function () {
  if (
    myControls.classList.contains("fa-shuffle") &&
    !myControls.classList.contains("pink")
  ) {
    isRandom = !isRandom;
    myControlBtn.title = "Repeat";
    myControls.classList.add("pink");
  } else if (
    myControls.classList.contains("fa-shuffle") &&
    myControls.classList.contains("pink")
  ) {
    isRandom = !isRandom;
    isRepeat = !isRepeat;
    myControlBtn.title = "Random";
    myControls.classList.remove("fa-shuffle");
    myControls.classList.add("fa-repeat");
  } else {
    isRepeat = !isRepeat;
    myControls.classList.add("fa-shuffle");
    myControls.classList.remove("fa-repeat");
    myControls.classList.remove("pink");
  }
});

// Random Song
let playedSongs = [];
function randomSong() {
  let randomIndex;
  let randomSong;
  do {
    randomIndex = Math.floor(Math.random() * allMusic.length);
    randomSong = allMusic[randomIndex];
  } while (playedSongs.includes(randomSong));

  // Thêm bài hát được random vào danh sách các bài đã được phát
  playedSongs.push(randomSong);

  // Nếu tất cả bài hát đã được phát thì reset lại danh sách
  if (playedSongs.length == allMusic.length) {
    playedSongs = [];
  }
  return randomIndex;
}

// Lấy tham chiếu đến phần tử bảng chọn
// let dropdownMenu = document.querySelector(".dropdown-menu");
// let dropdownOptions = document.querySelectorAll(".dropdown-menu li");

// playbackTimeBtn.addEventListener("click", function () {
//   dropdownMenu.classList.toggle("show");
// });

// dropdownOptions.forEach(function (option) {
//   option.addEventListener("click", function () {
//     let selectedValue = option.getAttribute("data-value");
//     console.log("Đã chọn: ", selectedValue);
//     dropdownOptions.addEventListener("click", function () {
//       dropdownMenu.classList.remove("show");
//       playbackTime(selectedValue);
//     });
//     // Gọi function hoặc thực hiện các thao tác khác ở đây
//   });
// });

// Playback time
let stopTime = 3600;
function playbackTime() {
  if (!isPlaybackTime) {
    playbackTimeBtn.classList.add("pink");
    playbackTimer.classList.add("show");
    // CountDown
    let minutes = Math.floor(stopTime / 60);
    let seconds = Math.floor(stopTime % 60);
    if (seconds < 10) {
      seconds = `0${seconds}`;
    }
    playbackTimer.innerText = `${minutes}:${seconds}`;
    countdown = setInterval(function () {
      if (seconds == 0) {
        seconds = 59;
        minutes--;
      } else {
        seconds--;
      }
      if (seconds < 10) {
        seconds = `0${seconds}`;
      }
      playbackTimer.innerText = `${minutes}:${seconds}`;
    }, 1000);
    // Stop Music
    stopMusic = setTimeout(function () {
      playbackTimeBtn.classList.remove("pink");
      playbackTimer.classList.remove("show");
      clearInterval(countdown);
      isPlaybackTime = false;
      pauseSong();
    }, stopTime * 1000);
    isPlaybackTime = true;
  } else {
    clearTimeout(stopMusic);
    clearInterval(countdown);
    playbackTimeBtn.classList.remove("pink");
    playbackTimer.classList.remove("show");
    isPlaybackTime = false;
  }
}

playbackTimeBtn.addEventListener("click", function () {
  playbackTime();
});
// progress
songAudio.addEventListener("timeupdate", (e) => {
  const currentTime = e.target.currentTime;
  const duration = e.target.duration;
  let progressWidth = (currentTime / duration) * 100;
  progressbar.style.width = `${progressWidth}%`;

  let musicCurrentTime = document.querySelector(".current");
  let musicDuration = document.querySelector(".duration");
  songAudio.addEventListener("loadeddata", () => {
    let audioduration = songAudio.duration;
    let totalMusicmin = Math.floor(audioduration / 60);
    let totalMusicsec = Math.floor(audioduration % 60);
    if (totalMusicsec < 10) {
      totalMusicsec = `0${totalMusicsec}`;
    }
    musicDuration.innerText = `${totalMusicmin}:${totalMusicsec}`;
  });
  let currentMusicmin = Math.floor(currentTime / 60);
  let currentMusicsec = Math.floor(currentTime % 60);
  if (currentMusicsec < 10) {
    currentMusicsec = `0${currentMusicsec}`;
  }
  musicCurrentTime.innerText = `${currentMusicmin}:${currentMusicsec}`;
});

// ----------- Tua nhạc-------
progress.addEventListener("click", (e) => {
  let progressWidthval = progress.clientWidth;
  let clickOffsetX = e.offsetX;
  let songDuration = songAudio.duration;
  songAudio.currentTime = (clickOffsetX / progressWidthval) * songDuration;
  playSong();
});
